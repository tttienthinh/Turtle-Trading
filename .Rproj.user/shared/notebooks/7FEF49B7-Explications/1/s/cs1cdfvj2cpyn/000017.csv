"0","# CUMPROD"
"0","getCumProd <- function(result, factor=1, fees=0.0006) {"
"0","  return (result %>%"
"0","    mutate("
"0","      bEARN=(bEARN-fees) %>% na.fill(fill=1), sEARN=(sEARN-fees) %>% na.fill(fill=1),"
"0","      bCUMUL = cumprod(bEARN), sCUMUL = cumprod(sEARN),"
"0","      bEARNpow = ((bEARN-1)*bRISK/factor+1), sEARNpow = ((sEARN-1)*sRISK/factor+1),"
"0","      bEARNpow = na.fill(bEARNpow, 1), sEARNpow = na.fill(sEARNpow, 1),"
"0","      bCUMULpow = cumprod(bEARNpow), sCUMULpow = cumprod(sEARNpow)"
"0","    )"
"0","  )"
"0","}"
"0","result <- result %>% getCumProd()"
"0","# Reshape data from wide to long format"
"0","x_long <- result %>% "
"0","  rowid_to_column(""x"") %>% "
"0","  melt(id.vars =""x"", measure.vars = c(""sCUMUL"", ""bCUMUL""))"
"0","ggplot(x_long, aes(x=x, y = value)) +"
"0","  geom_point(aes(color = variable)) +"
"0","  scale_y_continuous(trans='log10') +"
"0","  xlab(""Date"") +"
"0","  ylab(""Returns (Ã©chelle log10)"") "
