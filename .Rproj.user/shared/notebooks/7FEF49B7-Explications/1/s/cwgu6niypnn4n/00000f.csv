"0","# Curve earnpow"
"0","x <-data.frame(x=c((20:100)/10))"
"0","mapGetCumProd <- function(result, factor, col) {"
"0","  aux <- function(x) {"
"0","    getCumProd(result, x) %>%  "
"0","      select(col) %>% "
"0","      slice(n()) %>% "
"0","      as.double()"
"0","  }"
"0","  return (map_dbl(factor, aux))"
"0","}"
"0","x <- x %>% "
"0","  mutate("
"0","    yb=result %>% "
"0","      mapGetCumProd(x, ""bCUMULpow""),"
"0","    ys=result %>% "
"0","      mapGetCumProd(x, ""sCUMULpow""),"
"0","    yBoth=yb*ys"
"0","  )"
"0","# Reshape data from wide to long format"
"0","x_long <- melt(x, id.vars = ""x"", measure.vars = c(""ys"", ""yb"", ""yBoth""))"
"0","ggplot(x_long, aes(x = x, y = value)) +"
"0","  geom_point(aes(color = variable)) +"
"0","  xlab(""Factor of RISK, plus il est petit, plus on prend de risque"") +"
"0","  ylab(""Returns"") +"
"0","  geom_vline(xintercept = x[which.max(x$ys), ""x""], linetype = ""dashed"", color = 2) +"
"0","  geom_vline(xintercept = x[which.max(x$yb), ""x""], linetype = ""dashed"", color = 3) +"
"0","  geom_vline(xintercept = x[which.max(x$yBoth), ""x""], linetype = ""dashed"", color = 4)"
